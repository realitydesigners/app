---
import DarkBlogPost from '../../components/DarkBlogPost.astro'
import LightBlogPost from '../../components/LightBlogPost.astro'
import BlogLayout from '../../layouts/BlogLayout.astro'
import { getPostBySlug } from '../../lib/api.js'
import { getSanityImageURL } from '../../utils/helpers'

export async function getStaticPaths() {
  const allBlogPosts = await getPostBySlug()

  return allBlogPosts.map((post: any) => ({
    params: { slug: post.slug.current },
    props: { post },
  }))
}

const { post = {} as any } = Astro.props
---

<BlogLayout
  title={post.title}
  description={post.excerpt}
  imageURL={getSanityImageURL(post.image).url()}
>
  {post.layout === 'dark' && <DarkBlogPost post={post} />}
  {post.layout === 'light' && <LightBlogPost post={post} />}
</BlogLayout>
